<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="../public/styles/ui.css" />
    <link rel="shortcut icon" type="image/png" href="/favicon.png"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="../public/scripts/require.js"></script>
    <!--<script src="../public/scripts/code.js"></script>-->
    <script>
      var roomButtons = [];
      attachButtonEvents = function(pRoomButtons) {
        for (var i=0; i<pRoomButtons.length; i++)
        {
          let roomId = roomButtons.length;
          pRoomButtons[i].onclick = function()
          {
            for (var j=0; j<roomButtons.length; j++)
            {
              if (j != roomId) $(roomButtons[j]).removeClass("selected");
            }
            $(roomButtons[roomId]).addClass("selected");
          }
          pRoomButtons[i].ondblclick = function()
          {
            console.log("JOIN " + roomId);
          }
          roomButtons[roomId] = pRoomButtons[i];
        }
      };
      createRoomButtons = function(rooms) {
        for (var i in rooms)
        {
          var room = rooms[i];
          var p = $("<p>");
          p.html("Room " + room.id);
          var newElement = $("<div>");
          newElement.prop('id', room.id);
          newElement.append(p);
          $("#rooms").append(newElement);
          attachButtonEvents(newElement);
        }
      };

      requestNewRoom = function()
      {
        $.ajax({
          method: "GET",
          url: "/newRoom"
        }).done(function(roomInfo) {
          createRoomButtons(roomInfo);
        });
      };

      initialise = function() {
        $.ajax({
          method: "GET",
          url: "/info/rooms"
        }).done(function(roomInfo) {
          //createRoomButtons(roomInfo.rooms);
          $("#footer").click(requestNewRoom);
        });
      };

      $(document).ready(initialise);
    </script>
  </head>
  <body>
    <!--
    <div id="centre">
      <div id="rooms">
      </div>
      <div id="footer">
        <p>New Room</p>
      </div>
    </div>
    -->
    <div id="centre">
      <div id="footer">
        <div class="button">
          <p>New Room</p>
        </div>
          <div class="button">
            <p>Join Room</p>
          </div>
      </div>
    </div>
  </body>
</html>
